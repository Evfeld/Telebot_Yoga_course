import schedule
import threading
from threading import Thread
import time
import json
from time import sleep
import telebot
import pandas as pd
from telebot import types
import datetime
from datetime import date, timedelta
from bob_telegram_tools.bot import TelegramBot
from telebot.types import ReplyKeyboardMarkup, InlineKeyboardMarkup, InlineKeyboardButton
import os

bot = telebot.TeleBot(os.environ['TG_TOKEN'])
today = date.today()
if today.strftime('%Y-%m-%d') == '2023-10-23':
    lesson = '<b>–£–†–û–ö 1. –ó–ï–ú–õ–Ø</b> \n' \
    '–û—Å—Ç–∞–Ω–æ–≤–∫–∞: –ó–µ–º–ª—è \n\n' \
    '–ô–æ–≥–∞  –∏ –º–µ–¥–∏—Ç–∞—Ü–∏—è –ø–æ–¥–≤–æ–¥—è—Ç –Ω–∞—Å –∫ –Ω–∞—Å—Ç–æ—è—â–µ–º—É –º–æ–º–µ–Ω—Ç—É, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º—É –º–µ—Å—Ç—É, –≥–¥–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∂–∏–∑–Ω—å. –ù–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å –≤ –ø—Ä–æ—Å—Ç–æ—Ä–∞—Ö –Ω–∞—à–µ–π –≥–∞–ª–∞–∫—Ç–∏–∫–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ –æ –∂–∏–∑–Ω–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–Ω–æ–π –ø–ª–∞–Ω–µ—Ç–µ ‚Äî –ø–ª–∞–Ω–µ—Ç–µ –ó–µ–º–ª—è. \n\n' \
    '–° –ó–µ–º–ª–∏, –∏ —Å –ø—Ä–∞–∫—Ç–∏–∫–∏ –ù–∞–º–µ—Ä–µ–Ω–∏—è, –º—ã –∏ –Ω–∞—á–Ω—ë–º –Ω–∞—à–µ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ —É–≥–æ–ª–∫–∞–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –≤—Å–µ–ª–µ–Ω–Ω–æ–π.\n\n' \
    '<a href="https://youtu.be/3HlhKcWDUNA?feature=shared">–°—Å—ã–ª–∫–∞ –Ω–∞ —É—Ä–æ–∫</a>\n\n' \
    '#lesson1'
elif today.strftime('%Y-%m-%d') == '2023-10-24':
    lesson = '<b>–£–†–û–ö 2. –ü–ª–∞–Ω–µ—Ç–∞ –ê–ª–º–∞–∑–æ–≤ Cancri e</b> \n' \
    '–û—Å—Ç–∞–Ω–æ–≤–∫–∞: –ø–ª–∞–Ω–µ—Ç–∞ Cancri e \n\n' \
    '–û–Ω–∞ –≤—Ä–∞—â–∞–µ—Ç—Å—è –≤–æ–∫—Ä—É–≥ –∑–≤–µ–∑–¥—ã, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –°–æ–ª–Ω—Ü–µ, –≤ —Å–æ–∑–≤–µ–∑–¥–∏–∏ –†–∞–∫–∞. –ì–æ–¥ –Ω–∞ –Ω–µ–π —Ä–∞–≤–µ–Ω –Ω–∞—à–∏–º 18 —á–∞—Å–∞–º.–û–Ω–∞ –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –ó–µ–º–ª–∏ –∏ –Ω–∞ —Ç—Ä–µ—Ç—å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –∞–ª–º–∞–∑–∞. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —Å–∫–æ–ª—å–∫–æ –æ–Ω–∞ –º–æ–∂–µ—Ç —Å—Ç–æ–∏—Ç—å? \n\n' \
    '–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∞–ª–º–∞–∑–æ–≤, –∑–¥–æ—Ä–æ–≤–∞—è —Å–ø–∏–Ω–∞ ‚Äî –±–µ—Å—Ü–µ–Ω–Ω–∞. –ò –Ω–µ –∑—Ä—è –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ –º—ã –º–æ–ª–æ–¥—ã –Ω–∞—Å—Ç–æ–ª—å–∫–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≥–∏–±–∫–∏–π –Ω–∞—à –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫. –°–µ–≥–æ–¥–Ω—è –º—ã –∫–∞–∫ —Ä–∞–∑ –∏ –ø–æ—Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ —Ç–µ–º, —á—Ç–æ–±—ã –±—ã—Ç—å –µ—â—ë –º–æ–ª–æ–∂–µ –∏ –∑–¥–æ—Ä–æ–≤–µ–µ.\n\n' \
    '<a href="https://youtu.be/t4v3u6RCjM4?feature=shared">–°—Å—ã–ª–∫–∞ –Ω–∞ —É—Ä–æ–∫</a>\n\n' \
    '#lesson2'
elif today.strftime('%Y-%m-%d') == '2023-10-25':
    lesson = '<b>–£–†–û–ö 3. –¢–∞–±–∞—Ç–∞ - —Å–∏–ª–æ–≤–∞—è –±–∞–∑–∞ –π–æ–≥–∏.</b> \n' \
    '–û—Å—Ç–∞–Ω–æ–≤–∫–∞: –ì–∞–ª–∞–∫—Ç–∏–∫–∞ —Å–æ–º–±—Ä–µ—Ä–æ \n\n' \
    '–¢–æ–ª—å–∫–æ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —ç—Ç—É –≤—Å–µ–ª–µ–Ω–Ω—É—é! –í–æ–æ–±—â–µ ‚Äî —ç—Ç–æ –Ω–µ –æ–¥–Ω–∞ –≥–∞–ª–∞–∫—Ç–∏–∫–∞, –∞ —Ü–µ–ª—ã—Ö –¥–≤–µ. –≠—Ç–æ—Ç –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π –æ–±—ä–µ–∫—Ç –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ–Ω —Ç–µ–º, —á—Ç–æ –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–≤–µ—Ä—Ö–º–∞—Å—Å–∏–≤–Ω–∞—è —á—ë—Ä–Ω–∞—è –¥—ã—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ –º–∞—Å—Å–µ, –∫–∞–∫ 1 –º–ª—Ä–¥ –Ω–∞—à–∏—Ö –°–æ–ª–Ω—Ü.\n\n' \
    '–¢–æ—á–Ω–æ —Ç–∞–∫–∂–µ, –∫–∞–∫ –≥–∞–ª–∞–∫—Ç–∏–∫–∞ –°–æ–º–±—Ä–µ—Ä–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ —Å—Ä–∞–∑—É —Ç—Ä–∏ –æ–±—ä–µ–∫—Ç–∞ –≤ –æ–¥–Ω–æ–º, –º—ã –±—É–¥–µ–º —Ä–∞–∑–≤–∏–≤–∞—Ç—å –≤ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–º –∑–∞–Ω—è—Ç–∏–∏ —Å—Ä–∞–∑—É —Ç—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞: —Å–∏–ª—É, –≥–∏–±–∫–æ—Å—Ç—å –∏–∏–∏...–≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å! –ò–º–µ–Ω–Ω–æ —ç—Ç–∏–º –∏ —Å–ª–∞–≤—è—Ç—Å—è –π–æ–≥–æ–≤—Å–∫–∏–µ —Ç–∞–±–∞—Ç—ã.\n\n' \
    '–¢–∞–±–∞—Ç–∞ ‚Äî —ç—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç –≤ —Å—Ç—Ä–æ–≥–æ–º —Ä–µ–∂–∏–º–µ —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏—è –Ω–∞–≥—Ä—É–∑–æ–∫ (20 —Å–µ–∫—É–Ω–¥) –∏ –æ—Ç–¥—ã—Ö–∞ (10 —Å–µ–∫—É–Ω–¥). –†–µ–±—è—Ç–∞, —ç—Ç–æ –ø—Ä–∞–≤–¥–∞ —Ç—è–∂–µ–ª–æ, –ª—É—á—à–µ –¥–µ–ª–∞—Ç—å –ù–ï –Ω–∞ –Ω–æ—á—å :) –ù–æ! –û–Ω–æ —Ç–æ–≥–æ —Å—Ç–æ–∏—Ç. –†–µ–ª—å–µ—Ñ –∑–∞ —Å—á–µ—Ç —Ç–∞–∫–æ–≥–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è üí™\n\n' \
    '‚ùóÔ∏è–ü–µ—Ä–µ–¥ —Ç–∞–±–∞—Ç–æ–π –Ω–µ–º–Ω–æ–≥–æ —Ä–∞–∑–æ–º–Ω–∏—Ç–µ –∫–∏—Å—Ç–∏, –∏ –ø–æ—Å–ª–µ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–¥–µ–ª–∞–π—Ç–µ —à–∞–≤–∞—Å–∞–Ω—É.\n' \
    '<a href="https://youtu.be/efYGKgC7Q6w?feature=shared">–°—Å—ã–ª–∫–∞ –Ω–∞ —É—Ä–æ–∫</a>\n\n' \
    '#lesson3'
elif today.strftime('%Y-%m-%d') == '2023-10-26':
    lesson = '<b>–£–†–û–ö 4. –ß–∞–Ω–¥—Ä–∞ –ù–∞–º–∞—Å–∫–∞—Ä</b> \n' \
    '–û—Å—Ç–∞–Ω–æ–≤–∫–∞: –õ—É–Ω–∞ \n\n' \
    '–°–µ–≥–æ–¥–Ω—è –º—ã –ø—Ä–∏–±—ã–ª–∏ –Ω–∞ —Å–ø—É—Ç–Ω–∏–∫ –ó–µ–º–ª–∏ ‚Äî –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞ –õ—É–Ω—É, –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–π –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–∞ –ó–µ–º–ª–µ –º–æ—Ä—Å–∫–∏–µ –ø—Ä–∏–ª–∏–≤—ã –∏ –æ—Ç–ª–∏–≤—ã. –õ—É–Ω—É –º—ã –ø–æ–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º —Ü–∏–∫–ª–∏—á–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ß–∞–Ω–¥—Ä–∞ –ù–∞–º—Å–∫–∞—Ä (–Ω–∞ —Å–∞–Ω—Å–∫—Ä–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –∫–∞–∫ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –õ—É–Ω–µ –∏–ª–∏ —Å–∏—è–Ω–∏–µ –ª—É–Ω–Ω–æ–≥–æ —Å–≤–µ—Ç–∞).\n\n' \
    '14 –∞—Å–∞–Ω –ß–∞–Ω–¥—Ä–∞ –ù–∞–º–∞—Å–∫–∞—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç 14 –ª—É–Ω–Ω—ã—Ö —Ñ–∞–∑. –í –ª—É–Ω–Ω–æ–º –∫–∞–ª–µ–Ω–¥–∞—Ä–µ 14 –¥–Ω–µ–π –¥–æ –ø–æ–ª–Ω–æ–ª—É–Ω–∏—è –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è ¬´—Å—É–∫–ª–∞ –ø–∞–∫—à–∞¬ª ‚Äî —Å–≤–µ—Ç–ª—ã–µ –¥–≤–µ –Ω–µ–¥–µ–ª–∏, –∞ 14 –¥–Ω–µ–π –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–ª—É–Ω–∏—è ‚Äî ¬´–∫—Ä–∏—à–Ω–∞ –ø–∞–∫—à–∞¬ª, —Ç–æ –µ—Å—Ç—å —Ç–µ–º–Ω—ã–µ –¥–≤–µ –Ω–µ–¥–µ–ª–∏. –ò–º—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é –∞—Å–∞–Ω—É –≤ —ç—Ç–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ –π–æ–≥–∏.\n\n' \
    '–ê —Ç–µ–º, –∫—Ç–æ –Ω–µ –æ—á–µ–Ω—å –ª—é–±–∏—Ç —Ü–∏–∫–ª–∏—á–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏, —è –∑–∞–ø–∏—Å–∞–ª–∞ –µ—â—ë –ø—Ä–∞–∫—Ç–∏–∫—É –ù–ê –û–°–ù–û–í–ï –ß–∞–Ω–¥—Ä–∞ –ù–∞–º–∞—Å–∫–∞—Ä. –í—ã–±–∏—Ä–∞–π—Ç–µ –ª—é–±—É—é, –∏ –ø–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –≥–ª–∞–≤–Ω–æ–µ - –Ω–∞–±–ª—é–¥–∞—Ç—å, –∞ –Ω–µ –∞—Å–∞–Ω—ã.\n\n' \
    'üåô–ü—Ä–∞–∫—Ç–∏–∫—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å –≤–µ—á–µ—Ä–æ–º.\n' \
    '<a href="https://youtu.be/t4v3u6RCjM4?feature=shared">–°—Å—ã–ª–∫–∞ –Ω–∞ —É—Ä–æ–∫</a>\n\n' \
    '#lesson4'
elif today.strftime('%Y-%m-%d') == '2023-10-27':
    lesson = '<b>–£–†–û–ö 5. –î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞</b> \n' \
    '–û—Å—Ç–∞–Ω–æ–≤–∫–∞: –û–¢–ö–†–´–¢–´–ô –ö–û–°–ú–û–° \n\n' \
    '–í—Å–µ–º –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –∫–æ—Å–º–æ—Å–µ - –≤–∞–∫—É—É–º, –∏ –¥—ã—à–∞—Ç—å —Ç–∞–º –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω—ã–º. –û–¥–Ω–∞–∫–æ –π–æ–≥–∞–º –∏ —Ç–∞–∫–∞—è –ø—Ä–µ–≥—Ä–∞–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ –ø–ª–µ—á—É. \n\n' \
    '–†–∞—Å—Å–∫–∞–∂—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç. –ï—Å—Ç—å –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –π–æ–≥–∏ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–ª–∏ –¥—ã—Ö–∞–Ω–∏–µ –æ—Ç 30 –¥–æ 60 –º–∏–Ω—É—Ç. –ù–æ –∫–∞–∫??? –í —ç—Ç–æ —Å–ª–æ–∂–Ω–æ –ø–æ–≤–µ—Ä–∏—Ç—å, –Ω–æ –æ—Å–Ω–æ–≤–Ω—É—é —Ä–æ–ª—å –≤ —ç—Ç–æ–º –∏–≥—Ä–∞—é—Ç –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã. –ô–æ–≥–∏ —É–º–µ—é—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–µ–π –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π - —É–º–µ–Ω—å—à–∞—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø—É–ª—å—Å–∞, —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å –¥–∞–≤–ª–µ–Ω–∏–µ. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç–µ? \n\n' \
    '–ö –∑–∞–¥–µ—Ä–∂–∫–∞–º –Ω—É–∂–Ω–æ –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è, –Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –Ω–∞–¥–æ –Ω–µ —Å –∑–∞–¥–µ—Ä–∂–µ–∫, –∞ —Å –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫. –° –Ω–∏—Ö-—Ç–æ –º—ã –∏ –Ω–∞—á–Ω—ë–º:\n' \
    '&#129729; –î—ã—Ö–∞–Ω–∏–µ –£–¥–∂–∞–π–∏ - —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–π —Ü–∏–∫–ª.\n' \
    '&#129729; –ö–∞–ø–∞–ª–∞–±—Ö–∞—Ç–∏ - –Ω–∞–æ–±–æ—Ä–æ—Ç, —É–º–µ–Ω—å—à–∞–µ—Ç –∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –≤—ã–≤–æ–¥—É –°–û2.\n\n' \
    '–ö—Å—Ç–∞—Ç–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –≤ –π–æ–≥–µ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏–¥—É—Ç –ø–æ—Å–ª–µ –∞—Å–∞–Ω, –∫–∞–∫ –±—ã —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—É–ø–µ–Ω—å—é.\n\n' \
    '–ü–æ–µ—Ö–∞–ª–∏!\n\n' \
    '<a href="https://youtu.be/1SjLLTf5Uu8?feature=shared">–°—Å—ã–ª–∫–∞ –Ω–∞ —É—Ä–æ–∫</a>\n\n' \
    '#lesson5'
elif today.strftime('%Y-%m-%d') == '2023-10-28':
    lesson = '<b>–£–†–û–ö 6. –ñ–∏–≤–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞</b> \n' \
    '–û—Å—Ç–∞–Ω–æ–≤–∫–∞: Milky Way \n\n' \
    '–í —è—Å–Ω—ã–µ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –±–µ–∑–ª—É–Ω–Ω—ã–µ –Ω–æ—á–∏ –≤–¥–∞–ª–∏ –æ—Ç –º–µ–≥–∞–ø–æ–ª–∏—Å–∞, –≤–µ—Ä–æ—è—Ç–Ω–æ, –∫–∞–∂–¥–æ–º—É –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –≤–∏–¥–µ—Ç—å –Ω–∞ –Ω–µ–±–µ –º–æ–ª–æ—á–Ω–æ-–±–µ–ª—É—é –ø–æ–ª–æ—Å—É, –∫–æ—Ç–æ—Ä–∞—è –∫–∞–∫ –±—ã –æ–ø–æ—è—Å—ã–≤–∞–µ—Ç –Ω–µ–±–æ—Å–≤–æ–¥. –°–ª–æ–≤–Ω–æ —Ä–µ–∫–∞, —Ä–∞—Å—Ç–µ–∫–∞–µ—Ç—Å—è –ø–æ –Ω–µ–±—É —ç—Ç–æ—Ç –ø–æ—Ç–æ–∫ - –ú–ª–µ—á–Ω—ã–π –ø—É—Ç—å. \n\n' \
    '–°–µ–≥–æ–¥–Ω—è –º—ã –±—É–¥–µ–º –∏–¥—Ç–∏ –ø–æ –ú–ª–µ—á–Ω–æ–º—É –ø—É—Ç–∏ —Å—Ä–µ–¥–∏ —Å–≤–µ—Ç–∏–ª - —Ç–∞–∫–∏—Ö —è—Ä–∫–∏—Ö –∏ –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–≥–∫–æ –º–æ–≥—É—Ç –æ—Ç–≤–ª–µ—á—å –Ω–∞—à–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –Ω–æ –º—ã —É—á–∏–º—Å—è —Å–æ—Å—Ä–µ–¥–æ—Ç–∞—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ —Å–µ–±–µ, –Ω–∞ —Å–≤–æ–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º —Å–≤–µ—Ç–µ.\n\n' \
    '–ù–∞ —ç—Ç–æ–º –∑–∞–Ω—è—Ç–∏–∏ –º—ã –æ–±—ä–µ–¥–∏–Ω–∏–º –≤—Å–µ —Ç–æ, —á—Ç–æ –≤—ã—É—á–∏–ª–∏ –∑–∞ –Ω–µ–¥–µ–ª—é, –∏ –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ —É–≤–∏–¥–∏–º—Å—è ¬´–≤–∂–∏–≤—É—é¬ª. \n\n' \
    '–ù–∞—á–∞–ª–æ: 10:00\n' \
    '–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1:30\n' \
    '<a href="https://join.skype.com/Od8oDejQf9gc">–°—Å—ã–ª–∫–∞ –Ω–∞ Skype</a>\n\n' \
    '–†–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–µ –Ω—É–∂–Ω–æ, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ. –ò –µ—â–µ, –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –Ω–µ —Å–º–æ–∂–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è, <b>–∑–∞–ø–∏—Å—å –∑–∞–Ω—è—Ç–∏—è –∫–æ–Ω–µ—á–Ω–æ –∂–µ –±—É–¥–µ—Ç.</b>\n\n' \
    '#lesson6'
elif today.strftime('%Y-%m-%d') == '2023-10-29':
    lesson = '<b>–£–†–û–ö 7. –ô–æ–≥–∞-–ù–∏–¥—Ä–∞</b> \n' \
    '–û—Å—Ç–∞–Ω–æ–≤–∫–∞: –ö–≤–∞–∑–∞—Ä TON 618 \n\n' \
    '–°–µ–≥–æ–¥–Ω—è –º—ã –Ω—ã—Ä–Ω—ë–º –≤ –ø—É—á–∏–Ω—É –Ω–µ–∏–∑–≤–µ–¥–∞–Ω–Ω–æ–≥–æ, —Å–¥–µ–ª–∞–≤ –æ—Å—Ç–∞–Ω–æ–≤–∫—É –Ω–∞ —Å–∞–º–æ–π –æ–≥—Ä–æ–º–Ω–æ–π —á—ë—Ä–Ω–æ–π –¥—ã—Ä–µ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç: –µ—ë –º–∞—Å—Å–∞ –≤ 66 –º–ª—Ä–¥ —Ä–∞–∑ –±–æ–ª—å—à–µ –º–∞—Å—Å—ã –°–æ–ª–Ω—Ü–∞. –ö–≤–∞–∑–∞—Ä TON 618 ‚Äì —Å–∞–º–∞—è –±–æ–ª—å—à–∞—è –∏–∑ –∫–æ–≥–¥–∞-–ª–∏–±–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —á–µ—Ä–Ω—ã—Ö –¥—ã—Ä.\n\n' \
    '–ù–∞–≤–µ—Ä–Ω—è–∫–∞ –≤—ã —Å–ª—ã—à–∞–ª–∏ –æ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Ç—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Ä–∞–∑—É–º–∞: —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ–º, –ø–æ–¥—Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ–º –∏ –±–µ—Å—Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ–º. –ù–∞—à —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã–π —É–º –∫–∞–∂–µ—Ç—Å—è –Ω–∞–º –∫–∞–ø–∏—Ç–∞–Ω–æ–º –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ—Ä–∞–±–ª—è, –≤–µ–¥—å —ç—Ç–æ –Ω–∞—à ¬´–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä¬ª, —ç—Ç–æ –Ω–∞—à–µ –Ø. –û–¥–Ω–∞–∫–æ... –∏–º–µ–Ω–Ω–æ –≤ –¥—Ä—É–≥–∏—Ö –æ—Ç–¥–µ–ª–∞—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞—à–µ–π –∂–∏–∑–Ω—å—é (–æ—Ç—Ç—É–¥–∞ –±–µ—Ä—É—Ç—Å—è –±–ª–æ–∫–∏, –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤ –∂–∏–∑–Ω–∏ –∏ —Ç.–¥.), –∞ –º—ã —ç—Ç–æ–≥–æ –¥–∞–∂–µ –Ω–µ –æ—Å–æ–∑–Ω–∞—ë–º.\n\n' \
    '–°–µ–≥–æ–¥–Ω—è –º—ã –ø–æ–ø—Ä–æ–±—É–µ–º –¥–æ–±—Ä–∞—Ç—å—Å—è –¥–æ —ç—Ç–æ–π —á—ë—Ä–Ω–æ–π –¥—ã—Ä—ã —á–µ—Ä–µ–∑ –ô–æ–≥–∞-–ù–∏–¥—Ä—É. –ü—Ä–∞–∫—Ç–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ NSDR ‚Äì non-sleep deep rest. –≠—Ç–æ –ø—Ä–∞–∫—Ç–∏–∫–∞ –≥–ª—É–±–æ–∫–æ–≥–æ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –º–µ–¥–∏—Ç–∞—Ü–∏–∏ —Å–Ω–∏–∂–µ–Ω–Ω—ã–º —É—Ä–æ–≤–Ω–µ–º –±–æ–¥—Ä—Å—Ç–≤–æ–≤–∞–Ω–∏—è. –ú—ã –Ω–µ —Å–ø–∏–º, –Ω–æ –∏ –Ω–µ —Å—Ç–∞—Ä–∞–µ–º—Å—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —è—Å–Ω–æ—Å—Ç—å —Å–æ–∑–Ω–∞–Ω–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–Ω–∏–º–∞–Ω–∏—è, –∫–∞–∫ –≤ –º–µ–¥–∏—Ç–∞—Ü–∏–∏.\n\n' \
    '–î–∞–∂–µ –µ—Å–ª–∏ –≤—ã —É—Å–Ω—ë—Ç–µ, –∑–Ω–∞–π—Ç–µ, —Ä–∞–±–æ—Ç–∞ –∏–¥—ë—Ç\n\n' \
    'üåô –õ—É—á—à–µ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º –ø–µ—Ä–µ–¥ —Å–Ω–æ–º –≤ –ª—é–±–∏–º–æ–π –∫—Ä–æ–≤–∞—Ç–∏ –∏ –ø–æ–¥ –æ–¥–µ—è–ª–æ–º \n\n' \
    '<a href="https://youtu.be/t4v3u6RCjM4?feature=shared">–°—Å—ã–ª–∫–∞ –Ω–∞ —É—Ä–æ–∫</a>\n\n' \
    '#lesson7'
elif today.strftime('%Y-%m-%d') == '2023-10-30':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-10-31':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-01':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-02':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-03':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-04':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-05':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-06':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-07':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-08':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-09':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-10':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-11':
    lesson = lesson2
elif today.strftime('%Y-%m-%d') == '2023-11-12':
    lesson = lesson2

@bot.message_handler(commands=['start'])
def start(message):
    global markup
    lst1 = []
    name = message.from_user.id
    lst1.append(name)
    with open("chat_id.txt", "a") as file:
        for id in lst1:
            file.write(str(id) +'\n')
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    btn1 = types.KeyboardButton("–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ")
    btn2 = types.KeyboardButton("–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã")
    markup.add(btn1, btn2)
    markup1 = InlineKeyboardMarkup()
    markup1.add(InlineKeyboardButton(text='–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ', callback_data='addtask'))
    text = '–ù–∞–º–∞—Å—Ç–µüôè, {0.first_name} \n\n' \
    '–Ø –æ—á–µ–Ω—å —Ä–∞–¥–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—Å –Ω–∞ —ç—Ç–æ–º –∫—É—Ä—Å–µ! –ù–∞ –∫—É—Ä—Å–µ, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á–∏–∫–∏ –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å–≤–æ–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —á–µ—Ä–µ–∑ –ø–æ–∑–Ω–∞–Ω–∏–µ —Å–µ–±—è —Å –ø–æ–º–æ—â—å—é –¥—Ä–µ–≤–Ω–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –π–æ–≥–∏.\n\n' \
    '–°–∫–æ—Ä–æ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–µ—Ä–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ, –∞ –ø–æ–∫–∞ –¥–ª—è –≤–∞—Å –µ—Å—Ç—å –ø–æ—Å–ª–∞–Ω–∏–µ!'
    bot.send_message(message.chat.id, text=text.format(message.from_user), reply_markup=markup)  
    audio = open(r"Music.mp3", 'rb')
    bot.send_audio(message.chat.id, audio, title = '–ü–æ—Å–ª–∞–Ω–∏–µ', reply_markup=markup1)
    audio.close()

# –†–µ–∞–∫—Ü–∏—è –Ω–∞ –∫–Ω–æ–ø–∫–∏
@bot.message_handler(content_types=['text'])
def func(message):
    if message.text == "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ":
        lst1 = []
        name = message.from_user.id
        lst1.append(name)
        with open("chat_id.txt", "a") as file:
            for id in lst1:
                file.write(str(id) +'\n')
        with open('Schedule.json') as json_file:
            data = json.load(json_file, encoding='utf-8')
            sc = pd.read_json(data, orient='values')
            sc['–î–∞—Ç–∞'] = pd.to_datetime(sc['–î–∞—Ç–∞']).dt.date
            sc['d'] = pd.to_datetime(sc['–î–∞—Ç–∞']).dt.strftime('%d')
            sc['m'] = pd.to_datetime(sc['–î–∞—Ç–∞']).dt.strftime('%m').astype('int64')
            date = pd.DataFrame({'Month_num': [1,2,3,4,5,6,7,8,9,10,11,12], 
                                 'Month_name': ['—è–Ω–≤–∞—Ä—è','—Ñ–µ–≤—Ä–∞–ª—è','–º–∞—Ä—Ç–∞','–∞–ø—Ä–µ–ª—è','–º–∞—è','–∏—é–Ω—è','–∏–±–ª—è','–∞–≤–≥—É—Å—Ç–∞','—Å–µ–Ω—Ç—è–±—Ä—è','–æ–∫—Ç—è–±—Ä—è','–Ω–æ—è–±—Ä—è','–¥–µ–∫–∞–±—Ä—è']})
            sc = sc.merge(date, left_on = 'm', right_on = 'Month_num', how = 'left')
            sc['date_text'] = sc['d'] + ' ' + sc['Month_name']
            sc = sc[['–£—Ä–æ–∫','–î–∞—Ç–∞','–û–ø–∏—Å–∞–Ω–∏–µ','–°—Å—ã–ª–∫–∞','date_text']]
        lst = []
        for _,row in sc.iterrows():
            if row['–£—Ä–æ–∫'] == '–®–∞–≤–∞—Å–∞–Ω–∞':
                schedule = f"&#128301; <b>{row['–£—Ä–æ–∫']}</b>"'\n' + f"&#128467; {row['–û–ø–∏—Å–∞–Ω–∏–µ']}" + '\n' + f"{row['–°—Å—ã–ª–∫–∞']}" + '\n' + '_____________'
                lst.append(schedule)
            elif row['–£—Ä–æ–∫'] != '–®–∞–≤–∞—Å–∞–Ω–∞' and row['–î–∞—Ç–∞'] <= today:
                schedule = f"&#128301; <b>{row['–£—Ä–æ–∫']}</b>" + '\n' + f"&#128467; {row['date_text']}" + '\n' + f"{row['–û–ø–∏—Å–∞–Ω–∏–µ']}" + '\n' + f"{row['–°—Å—ã–ª–∫–∞']}" + '\n' + '_____________'
                lst.append(schedule)
            else:
                schedule = f"&#128301; <b>{row['–£—Ä–æ–∫']}</b>" + '\n' + f"&#128467; {row['date_text']}" + '\n' + f"{row['–û–ø–∏—Å–∞–Ω–∏–µ']}" + '\n' + f"<i>–°—Å—ã–ª–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –≤ –¥–µ–Ω—å —É—Ä–æ–∫–∞</i>" + '\n' + '_____________'
                lst.append(schedule)
        bot.send_message(message.chat.id, '\n'.join(lst), parse_mode="html")#, reply_markup = markup)
    elif message.text == "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã":
        lst1 = []
        name = message.from_user.id
        lst1.append(name)
        with open("chat_id.txt", "a") as file:
            for id in lst1:
                file.write(str(id) +'\n')
        send = '–ù–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤: \n' \
        '1. <b>–ó–∞–Ω—è—Ç–∏—è –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ —ç—Ç–æ–º –±–æ—Ç–µ.</b> –ü–æ—Å—Ç–∞—Ä–∞–π—Å—è –Ω–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å –∑–∞–Ω—è—Ç–∏—è, —á—Ç–æ–±—ã —É —Ç–µ–±—è –Ω–µ –Ω–∞–∫–æ–ø–∏–ª–æ—Å—å –º–Ω–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤. –ü–æ–ª–Ω–æ—Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏ –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞. \n' \
        '2. <b>–î–ª—è –≤—Å–µ—Ö –∑–∞–Ω—è—Ç–∏–π –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –∫–æ–≤—Ä–∏–∫.</b> –í–æ–∑–º–æ–∂–Ω–æ, –Ω–µ –ø–æ–º–µ—à–∞–µ—Ç –∏–º–µ—Ç—å —Ñ–∏—Ç–Ω–µ—Å-–±–ª–æ–∫–∏ –∏ —Ä–µ–º–µ—à–∫–∏. –ò—Ö —Å–º–µ–ª–æ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∫–Ω–∏–≥–∏ –∏ –ø–æ—è—Å –æ—Ç —Ö–∞–ª–∞—Ç–∞üòÖ \n' \
        '3. <b>–î–æ –∑–∞–Ω—è—Ç–∏—è –ª—É—á—à–µ –Ω–µ –µ—Å—Ç—å –∑–∞ 1,5-2 —á–∞—Å–∞.</b>\n' \
        '4. <b>–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è –¥–µ–ª–∞–π —à–∞–≤–∞—Å–∞–Ω—É (–ø—Ä–∞–∫—Ç–∏–∫–∞ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è).</b> –≠—Ç–æ –≤–∞–∂–Ω–æ! \n' \
        '5. <b>–í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –º–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å <a href="https://t.me/NataliLarina8">–ª–∏—á–Ω–æ</a> –∏–ª–∏ <a href="https://t.me/+oSpisjZHdR8yNzI6">–≤ –æ–±—â–µ–º —á–∞—Ç–µ.</a></b> \n' \
        '6. <b>–¢–∞–∫–∂–µ —è –¥–∞—Ä—é —Ç–µ–±–µ —Ç—Ä–µ–∫–µ—Ä, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ç—ã —Å–º–æ–∂–µ—à—å –æ—Ç–º–µ—á–∞—Ç—å —Å–≤–æ–∏ —É—Å–ø–µ—Ö–∏.</b> 21 –¥–µ–Ω—å - –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ, —á—Ç–æ–±—ã –Ω–µ —Å–ª–∏—Ç—å—Å—è, –Ω–æ –≤–ø–æ–ª–Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –∑–∞–ª–æ–∂–∏—Ç—å –∫–∏—Ä–ø–∏—á–∏–∫ –∫ –±–æ–ª—å—à–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º‚ù§Ô∏è'
        bot.send_message(message.from_user.id, send, parse_mode="html")
        treker = open(r"Tracker.pdf","rb")
        bot.send_document(message.chat.id, document = treker, visible_file_name = '–¢—Ä–µ–∫–µ—Ä.pdf')
        
@bot.callback_query_handler(func=lambda call:True)
def callback_query(call):
    req = call.data.split('_')
    if req[0] == 'addtask':
        send = '–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ç–æ–º, –∫–∞–∫ –≤—ã–±—Ä–∞—Ç—å –¥–ª—è —Å–µ–±—è –Ω–∞–º–µ—Ä–µ–Ω–∏–µ, —Ç—ã –º–æ–∂–µ—à—å –ø–æ—á–∏—Ç–∞—Ç—å –ø–æ —ç—Ç–æ–π <a href="https://www.oum.ru/yoga/osnovy-yogi/slovar-yogi-sankalpa/">—Å—Å—ã–ª–∫–µ</a> \n\n' \
        '–í—ã–ø–∏—à–∏ —Å–≤–æ—é —Å–∞–Ω–∫–∞–ª—å–ø—É –Ω–∞ –ª–∏—Å—Ç–æ–∫. –û–Ω–∞ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Ç–µ–±–µ –∫ –ø–µ—Ä–≤–æ–º—É –¥–Ω—é.\n\n' \
        '–£–¥–∞—á–∏! –í—Å—Ç—Ä–µ—á–∞–µ–º—Å—è –≤ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –Ω–∞ –ø–µ—Ä–≤–æ–º –∑–∞–Ω—è—Ç–∏–∏.'
        bot.send_message(call.from_user.id, send, parse_mode="html")

def schedule_checker():
    schedule.every().day.at("12:37").do(function_to_run, lesson = lesson)
    schedule.every(1).minutes.do(dont_sleep)
    while True:
        schedule.run_pending()
        sleep(1)

def function_to_run(lesson):
    fp = open('chat_id.txt','r')
    df = pd.DataFrame(fp,columns = ['chat_id'])
    df = df.drop_duplicates()
    df['chat_id'] = df['chat_id'].apply(lambda x: x.replace('\n',''))
    fp.close()
    for chat_id in df['chat_id']:
        print(chat_id)
        bot.send_message(chat_id, text = lesson, parse_mode="html")
        time.sleep(2)
    t1.should_abort_immediately = True

def dont_sleep():
    print(f"I'm not sleeping")

if __name__ == '__main__':
    t1 = Thread(target=schedule_checker, daemon=True)
    t2 = Thread(target=start)
    t1.start()
    t2.start()

bot.infinity_polling(timeout=10, long_polling_timeout = 5)

